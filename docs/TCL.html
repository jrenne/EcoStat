<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Central Limit Theorem | Econometrics and Statistics</title>
<meta name="author" content="Jean-Paul Renne">
<meta name="description" content="The law of large numbers (LLN) and the central limit theorem (CLT) are two fundamental theorems of probability. The former states that the sample mean converges in probability to the population...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 2 Central Limit Theorem | Econometrics and Statistics">
<meta property="og:type" content="book">
<meta property="og:description" content="The law of large numbers (LLN) and the central limit theorem (CLT) are two fundamental theorems of probability. The former states that the sample mean converges in probability to the population...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Central Limit Theorem | Econometrics and Statistics">
<meta name="twitter:description" content="The law of large numbers (LLN) and the central limit theorem (CLT) are two fundamental theorems of probability. The former states that the sample mean converges in probability to the population...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="my-style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Econometrics and Statistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Econometrics and statistics</a></li>
<li><a class="" href="Basics.html"><span class="header-section-number">1</span> Basic statistical results</a></li>
<li><a class="active" href="TCL.html"><span class="header-section-number">2</span> Central Limit Theorem</a></li>
<li><a class="" href="Tests.html"><span class="header-section-number">3</span> Statistical tests</a></li>
<li><a class="" href="ChapterLS.html"><span class="header-section-number">4</span> Linear Regressions</a></li>
<li><a class="" href="Panel.html"><span class="header-section-number">5</span> Panel regressions</a></li>
<li><a class="" href="estimation-methods.html"><span class="header-section-number">6</span> Estimation Methods</a></li>
<li><a class="" href="binary-choice-models.html"><span class="header-section-number">7</span> Binary-choice models</a></li>
<li><a class="" href="TS.html"><span class="header-section-number">8</span> Time Series</a></li>
<li><a class="" href="append.html"><span class="header-section-number">9</span> Appendix</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="TCL" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Central Limit Theorem<a class="anchor" aria-label="anchor" href="#TCL"><i class="fas fa-link"></i></a>
</h1>
<p>The law of large numbers (LLN) and the central limit theorem (CLT) are two fundamental theorems of probability. The former states that the sample mean converges in probability to the population mean (when it exists). The latter states that the distribution of the sum (or average) of a large number of independent, identically distributed (i.i.d.) variables with finite variance is approximately normal, regardless of the underlying distribution (as long as it features a finite variance).</p>
<div id="law-of-large-numbers" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Law of large numbers<a class="anchor" aria-label="anchor" href="#law-of-large-numbers"><i class="fas fa-link"></i></a>
</h2>
<div class="definition">
<p><span id="def:smplpop" class="definition"><strong>Definition 2.1  (Sample and Population) </strong></span>In statistics, a <em>sample</em> refers to a finite set of observations drawn from a <em>population</em>.</p>
</div>
<p>Most of the time, it is necessary to use samples for research, because it is impractical to study the whole population. Typically, it is rare to observe the population mean, and we often use instead sample means (or averages). The sample average of <span class="math inline">\(\{x_1,\dots,x_n\}\)</span> is given by:
<span class="math display">\[
\overline{x}_n = \frac{1}{n}\sum_{i=1}^n x_i.
\]</span>
This sample mean is an estimator of the true (population) mean <span class="math inline">\(\mathbb{E}(x_i)\)</span> (assuming the latter exists). According to the law of large numbers (Theorem <a href="TCL.html#thm:LLN">2.1</a>), this estimator is <em>consistent</em>. (see Def. <a href="append.html#def:convergenceproba">9.14</a> for the definition of convergence in probability.)</p>
<div class="theorem">
<p><span id="thm:LLN" class="theorem"><strong>Theorem 2.1  (Law of large numbers) </strong></span>The sample mean is a consistent estimator of the population mean. In other words, the sample mean converges in probability to the population mean.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-4" class="proof"><em>Proof</em>. </span>See Appendix <a href="append.html#CLTappend">9.3.4</a>.</p>
</div>
<div class="example">
<p><span id="exm:doctorVisits" class="example"><strong>Example 2.1  </strong></span>Suppose one is interested in the average number of doctor consultations over 12 months, for Swiss people. One can get an estimate by computing the sample average of a large dataset, for instance using the <a href="https://forscenter.ch/projects/swiss-household-panel/">Swiss Household Panel (SHP)</a>:</p>
<p>Figure <a href="TCL.html#fig:incomeDistri">2.1</a> shows the empirical distribution of the number of doctor visits.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">AEC</span><span class="op">)</span> <span class="co"># to load the shp data-frame.</span></span>
<span><span class="va">Nb.doct.visits</span> <span class="op">&lt;-</span> <span class="va">shp</span><span class="op">$</span><span class="va">p19c15</span></span>
<span><span class="va">Nb.doct.visits</span> <span class="op">&lt;-</span> <span class="va">Nb.doct.visits</span><span class="op">[</span><span class="va">Nb.doct.visits</span><span class="op">&gt;=</span><span class="fl">0</span><span class="op">]</span> <span class="co"># remove irrelevant observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>plt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.15</span>,<span class="fl">.95</span>,<span class="fl">.2</span>,<span class="fl">.95</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Nb.doct.visits</span><span class="op">)</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left-aligned">
<span style="display:block;" id="fig:incomeDistri"></span>
<img src="EcoStat_files/figure-html/incomeDistri-1.png" alt="Distribution of the number of doctor visits. Source: Swiss Household Panel." width="672"><p class="caption">
Figure 2.1: Distribution of the number of doctor visits. Source: Swiss Household Panel.
</p>
</div>
<p>Let us compute the sample mean, variance, and standard deviation:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Nb.doct.visits</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">Nb.doct.visits</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Nb.doct.visits</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##          [,1]     [,2]   [,3]
## [1,] 5.253816 79.50575 8.9166</code></pre>
</div>
<p>How to know whether the sample mean is a good estimate of the true (population) average? In other words, how to measure the accuracy of the estimator?</p>
<p>A first answer is provided by the Chebychev inequality. Assume the <span class="math inline">\(x_i\)</span>’s are independently drawn from a distribution of mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. We have:
<span class="math display">\[
\mathbb{E}(\bar{x}_n) = \mu \quad \mbox{ and } \quad \mathbb{V}ar(\mu - \bar{x}_n) = \frac{1}{n}\sigma^2 \underset{n \rightarrow \infty}{\rightarrow} 0.
\]</span>
The Chebychev inequality (Proposition <a href="append.html#prp:chebychev">9.11</a>) states that, for any <span class="math inline">\(\varepsilon &gt; 0\)</span> (even very small), we have:
<span class="math display">\[
\mathbb{P}(|\bar{x}_n-\mu|&gt;\varepsilon) \le \frac{\mathbb{V}ar(\mu - \bar{x}_n)}{\varepsilon^2} = \frac{\sigma^2}{n\varepsilon^2} \underset{n \rightarrow \infty}{\rightarrow} 0.
\]</span>
Consider for instance the estimation of the average number of doctor visits (Example <a href="TCL.html#exm:doctorVisits">2.1</a>). In this example, the sample length is <span class="math inline">\(n=\)</span> 4389, we have <span class="math inline">\(\bar{x}_n=\)</span> 5.25, and the variance <span class="math inline">\(\sigma^2\)</span> was approximately equal to 79.51. Therefore, taking <span class="math inline">\(\varepsilon=0.5\)</span>, we have that <span class="math inline">\(\mathbb{P}(\bar{x}_n-0.5&lt;\mu&lt;\bar{x}_n+0.5)\)</span> is lower than <span class="math inline">\(\frac{\sigma^2}{n\varepsilon^2} \approx\)</span>
0.072.</p>
<p>However, this only gives bounds for such probabilities. The central limit theorem provides richer information, as it gives the approximate distribution of the estimation error.</p>
</div>
<div id="central-limit-theorem-clt" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Central Limit Theorem (CLT)<a class="anchor" aria-label="anchor" href="#central-limit-theorem-clt"><i class="fas fa-link"></i></a>
</h2>
<div class="theorem">
<p><span id="thm:LindbergLevyCLT" class="theorem"><strong>Theorem 2.2  (Lindberg-Levy Central limit theorem, CLT) </strong></span>If <span class="math inline">\(x_n\)</span> is an i.i.d. sequence of random variables with mean <span class="math inline">\(\mu\)</span> and (finite) variance, then:
<span class="math display">\[
\boxed{\sqrt{n} (\bar{x}_n - \mu) \overset{d}{\rightarrow} \mathcal{N}(0,\sigma^2), \quad \mbox{where} \quad \bar{x}_n = \frac{1}{n} \sum_{i=1}^{n} x_i.}
\]</span>
[“<span class="math inline">\(\overset{d}{\rightarrow}\)</span>” denotes the convergence in distribution (see Def. <a href="append.html#def:cvgceDistri">9.17</a>)]</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-5" class="proof"><em>Proof</em>. </span>See Appendix <a href="append.html#CLTappend">9.3.4</a>.</p>
</div>
<p>According to the CLT, when <span class="math inline">\(n\)</span> is large and whatever the distribution of the <span class="math inline">\(x_i\)</span>’s (as long as it features an average <span class="math inline">\(\mu\)</span> and a variance <span class="math inline">\(\sigma^2\)</span>), the error between <span class="math inline">\(\bar{x}_n\)</span> and <span class="math inline">\(\mu\)</span> can be seen as a random variable that is normally distributed; it is of mean zero and its standard deviation is <span class="math inline">\(\sigma/\sqrt{n}\)</span>. (We then say that the convergence rate is <em>in <span class="math inline">\(\sqrt{n}\)</span></em>.) The knowledge of the quantiles of the normal distribution can then be used to compute approximate confidence intervals for <span class="math inline">\(\mu\)</span> (based on the sample <span class="math inline">\(\{x_1,\dots,x_n\}\)</span>).</p>
<p>This <a href="https://jrenne.shinyapps.io/StatEcoII/">web interface</a> illustrates the CLT with simulations (select the “CLT” block).</p>
<p>The CL theorem was first postulated by the mathematician Abraham de Moivre. In an article published in 1733, he used the normal distribution to approximate the distribution of the number of heads resulting from many tosses of a fair coin. This finding was nearly forgotten until Pierre-Simon Laplace recalled it in his <a href="https://archive.org/details/thorieanalytiqu01laplgoog">Théorie analytique des probabilités</a>, published in 1812. Laplace expanded De Moivre’s finding by approximating the binomial distribution with the normal distribution.</p>
<div class="exercise">
<p><span id="exr:ExoBuffon" class="exercise"><strong>Exercise 2.1  </strong></span>Consider Buffon’s experiment (Example <a href="Basics.html#exm:Buffon">1.2</a>). We have seen that <span class="math inline">\(\pi\)</span> can be estimated by counting the fraction of times the needles cross the grooves of the floor.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;More precisely, the expectation of this fraction is equal to &lt;span class="math inline"&gt;\(1/\pi\)&lt;/span&gt;.&lt;/p&gt;'><sup>2</sup></a> Using the CLT, determine the (approximate) minimal number <span class="math inline">\(n\)</span> of needles that one has to throw to get an estimate <span class="math inline">\(\hat\pi\)</span> (<span class="math inline">\(= 1/\bar{X}_n\)</span>) of <span class="math inline">\(\pi\)</span> that is such that there is a 95% chance that <span class="math inline">\(\pi \in [\hat\pi-0.01,\hat\pi+0.01]\)</span>?</p>
</div>
<div class="exercise">
<p><span id="exr:ExoPileFace" class="exercise"><strong>Exercise 2.2  </strong></span>Assume you have a lot of time and a coin. How would you approximate the 100 percentiles of the <span class="math inline">\(\mathcal{N}(0,1)\)</span> distribution?</p>
</div>
<p>The CLT can be extended to the case where each <span class="math inline">\(x_i\)</span> is a vector. (In that case, and if the dimension of <span class="math inline">\(x_i\)</span> is <span class="math inline">\(m\)</span>, then <span class="math inline">\(\mathbb{V}ar(x_i)\)</span> is a <span class="math inline">\(m\times m\)</span> matrix.) Here is the multivariate CLT:</p>
<div class="theorem">
<p><span id="thm:MCLT" class="theorem"><strong>Theorem 2.3  (Multivariate Central limit theorem, CLT) </strong></span>If <span class="math inline">\(\mathbf{x}_n\)</span> is an i.i.d. sequence of <span class="math inline">\(m\)</span>-dimensional random variables with mean <span class="math inline">\(\boldsymbol\mu\)</span> and variance <span class="math inline">\(\Sigma\)</span>, where <span class="math inline">\(\Sigma\)</span> is a positive definite matrix, then:
<span class="math display">\[
\boxed{\sqrt{n} (\bar{\mathbf{x}}_n - \boldsymbol\mu) \overset{d}{\rightarrow} \mathcal{N}(\mathbf{0},\Sigma), \quad \mbox{where} \quad \bar{\mathbf{x}}_n = \frac{1}{n} \sum_{i=1}^{n} \mathbf{x}_i.}
\]</span></p>
</div>
</div>
<div id="comparison-of-sample-means" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Comparison of sample means<a class="anchor" aria-label="anchor" href="#comparison-of-sample-means"><i class="fas fa-link"></i></a>
</h2>
<p>As said at the beginning of this chapter, the CLT is a key statistical result that has numerous applications. An important one is the statistical comparision of sample means:</p>
<p>Consider two samples <span class="math inline">\(\{m_1,\dots,m_{n_m}\}\)</span> and <span class="math inline">\(\{w_1,\dots,w_{n_w}\}\)</span>. Assume that the <span class="math inline">\(m_i\)</span>’s (respectively the <span class="math inline">\(w_i\)</span>’s) are i.i.d., with mean <span class="math inline">\(\mu_m\)</span> and variance <span class="math inline">\(\sigma^2_m\)</span> and of <span class="math inline">\(w_i\)</span>’s (resp. with mean <span class="math inline">\(\mu_w\)</span> and variance <span class="math inline">\(\sigma^2_w\)</span>).</p>
<p>If <span class="math inline">\(n\)</span> is large, according to the CLT, we approximately have:
<span class="math display">\[
\sqrt{n_m}(\bar{m} - \mu_m) \sim \mathcal{N}(0,\sigma^2_m) \quad and \quad \sqrt{n_w}(\bar{w} - \mu_w) \sim \mathcal{N}(0,\sigma^2_w),
\]</span>
or
<span class="math display">\[
\bar{m} \sim \mathcal{N}\left(\mu_m,\frac{\sigma^2_m}{n_m}\right) \quad and \quad \bar{w} \sim \mathcal{N}\left(\mu_w,\frac{\sigma^2_w}{n_w}\right).
\]</span></p>
<p>if the <span class="math inline">\(m_i\)</span>’s and the <span class="math inline">\(w_i\)</span>’s are independent, then <span class="math inline">\(\bar{m}\)</span> and <span class="math inline">\(\bar{w}\)</span> also are, and we get:
<span class="math display">\[
\bar{m} - \bar{w} \sim \mathcal{N}\left(\mu_m-\mu_w,\sigma^2\right) \quad with \quad \sigma^2 = \frac{\sigma^2_m}{n_m}+\frac{\sigma^2_w}{n_w}.
\]</span>
This can be used to test the null hypothesis <span class="math inline">\(H_0: \; \mu_m-\mu_w = 0\)</span> (see Section <a href="Tests.html#Tests">3</a>). Indeed under this assumption, the probability that <span class="math inline">\(\bar{m} - \bar{w}\)</span> is in <span class="math inline">\([-1.96\sigma,1.96\sigma]\)</span> (respectively in <span class="math inline">\([-2.58\sigma,2.58\sigma]\)</span>) is approximately 0.95 (respectively 0.99) [see Table <a href="append.html#tab:Normal">9.1</a>].</p>
<p>For instance, if we find, using our sample, that <span class="math inline">\(\bar{m} - \bar{w}\)</span> is not in <span class="math inline">\([-2.58\sigma,2.58\sigma]\)</span>, then we reject the null hypothesis at the 1% significance level.</p>
<div class="example">
<p><span id="exm:comparSmplMeans" class="example"><strong>Example 2.2  (Comparison of sample means) </strong></span>Let us use the <a href="https://forscenter.ch/projects/swiss-household-panel/">Swiss Household Panel (SHP)</a> dataset to test the equality between men and women incomes, for Swiss people under the age of 35.</p>
<p>The next lines of codes construct two samples of incomes; one for men (<code>income.m</code>), and one for women (<code>income.w</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">AEC</span><span class="op">)</span>;<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">logKDE</span><span class="op">)</span></span>
<span><span class="va">dataset.m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">shp</span>,<span class="op">(</span><span class="va">sex19</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="va">age19</span><span class="op">&lt;=</span><span class="fl">35</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dataset.w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">shp</span>,<span class="op">(</span><span class="va">sex19</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="va">age19</span><span class="op">&lt;=</span><span class="fl">35</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">income.m</span> <span class="op">&lt;-</span> <span class="va">dataset.m</span><span class="op">$</span><span class="va">i19ptotg</span></span>
<span><span class="va">income.w</span> <span class="op">&lt;-</span> <span class="va">dataset.w</span><span class="op">$</span><span class="va">i19ptotg</span></span>
<span><span class="va">income.m</span> <span class="op">&lt;-</span> <span class="va">income.m</span><span class="op">[</span><span class="va">income.m</span><span class="op">&gt;=</span><span class="fl">0</span><span class="op">]</span> <span class="co"># remove irrelevant data</span></span>
<span><span class="va">income.w</span> <span class="op">&lt;-</span> <span class="va">income.w</span><span class="op">[</span><span class="va">income.w</span><span class="op">&gt;=</span><span class="fl">0</span><span class="op">]</span> <span class="co"># remove irrelevant data</span></span></code></pre></div>
<p>Figure <a href="TCL.html#fig:RcompMeans">2.2</a> displays the empirical densities of incomes for men and women. Vertical dashed lines indicate sample means:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>plt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.95</span>,<span class="fl">.2</span>,<span class="fl">.95</span><span class="op">)</span><span class="op">)</span> <span class="co"># adjust margins</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/logKDE/man/logdensity.html">logdensity</a></span><span class="op">(</span><span class="va">income.w</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200000</span><span class="op">)</span>,main<span class="op">=</span><span class="st">""</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Yearly gross income (in CHF)"</span>,ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="co"># x and y labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/logKDE/man/logdensity.html">logdensity</a></span><span class="op">(</span><span class="va">income.m</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">income.m</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"red"</span>,lty<span class="op">=</span><span class="fl">3</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">income.w</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span>,lty<span class="op">=</span><span class="fl">3</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"men yearly income"</span>,<span class="st">"women"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: left-aligned">
<span style="display:block;" id="fig:RcompMeans"></span>
<img src="EcoStat_files/figure-html/RcompMeans-1.png" alt="Distribution of yearly gross incomes for Swiss residents under the age of 35. Source: SHP. Vertical dashed lines indicates the sample mean." width="672"><p class="caption">
Figure 2.2: Distribution of yearly gross incomes for Swiss residents under the age of 35. Source: SHP. Vertical dashed lines indicates the sample mean.
</p>
</div>
<p>Let us compute <span class="math inline">\(\bar{m}\)</span>, <span class="math inline">\(\bar{w}\)</span>, and <span class="math inline">\(\sigma\)</span>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m.bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">income.m</span><span class="op">)</span></span>
<span><span class="va">w.bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">income.w</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">income.m</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">income.m</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">income.w</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">income.w</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">m.bar</span>,<span class="va">w.bar</span>,<span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 53035.023 42708.227  2427.425</code></pre>
<p>Under the “equality assumption”, their would a probability of only 5% (respectively 1%) for <span class="math inline">\(\bar{m} - \bar{w}\)</span> not to be in <span class="math inline">\([\)</span>-4758,4758<span class="math inline">\(]\)</span> (respectively in <span class="math inline">\([\)</span>-6263,6263<span class="math inline">\(]\)</span>). Since <span class="math inline">\(\bar{m} - \bar{w}\)</span> is equal to 10327, we reject the null hypothesis at the 5%, and even 1%, significance levels.</p>
</div>
<!-- %\begin{frame} -->
<!-- %\begin{footnotesize} -->
<!-- %      \begin{figure} -->
<!-- %      \caption{The importance of the independence assumption} -->
<!-- %          \includegraphics[width=1\linewidth]{../../figures/Figure_CLT_indpdce.pdf} -->
<!-- % -->
<!-- %      \begin{tiny} -->
<!-- %      \flushleft{Note: The three samples have been simulated using the following data generating process: $x_i = \mu + \rho (x_{i-1}-\mu) + \sqrt{1-\rho^2}\varepsilon_i$, where $\varepsilon_i \sim \mathcal{N}(0,1)$. Case A: $\rho = 0$;  Case B: $\rho = 0.9$;  Case C: $\rho = 0.99$. In the three cases, $\mathbb{E}(X_i)=\mu=2$ and $\mathbb{V}ar(X_i)=1$.} -->
<!-- %      \end{tiny} -->
<!-- %      \end{figure} -->
<!-- % -->
<!-- %\end{footnotesize} -->
<!-- %\end{frame} -->
<!-- %\begin{frame} -->
<!-- %\begin{footnotesize} -->
<!-- %\begin{exercise}[Polls and confidence intervals] -->
<!-- %\begin{itemize} -->
<!-- %  \item The day before an election with two candidates (A and B), 100 persons are surveyed (randomly chosen). 51\% of them say they will vote for Candidate A. -->
<!-- %  \item[(a)] Assuming people do not change their mind before the vote, compute an approximation of the probability that A will win. -->
<!-- %   -->
<!-- %  (Hints: introduce $\theta$, the score that will be obtained by A; compute $\mathbb{P}(\theta > \mu + \bar{x}_n)$, where $x_i$ is equal to 1 if the $i^{th}$ respondent will votes for A and 0 otherwise). -->
<!-- %  \item[(b)] What is the probability if 55\% of them say they will vote for Candidate A. -->
<!-- %  \item[(c)] What would be that probability if 4000 people had been surveyed? (with 51\%) -->
<!-- %\end{itemize} -->
<!-- %\end{exercise} -->
<!-- %\begin{exercise}[Computer-free simulation of $\mathcal{N}$] -->
<!-- %\begin{itemize} -->
<!-- %  \item Assume you have a lot of time and a coin. How would you approximate the 100 percentiles of the Normal distribution? -->
<!-- %\end{itemize} -->
<!-- %\end{exercise} -->
<!-- %% Research on TCL and Casino: \url{http://digitalscholarship.unlv.edu/cgi/viewcontent.cgi?article=1293&context=grrj} -->
<!-- %\end{footnotesize} -->
<!-- %\end{frame} -->

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="Basics.html"><span class="header-section-number">1</span> Basic statistical results</a></div>
<div class="next"><a href="Tests.html"><span class="header-section-number">3</span> Statistical tests</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#TCL"><span class="header-section-number">2</span> Central Limit Theorem</a></li>
<li><a class="nav-link" href="#law-of-large-numbers"><span class="header-section-number">2.1</span> Law of large numbers</a></li>
<li><a class="nav-link" href="#central-limit-theorem-clt"><span class="header-section-number">2.2</span> Central Limit Theorem (CLT)</a></li>
<li><a class="nav-link" href="#comparison-of-sample-means"><span class="header-section-number">2.3</span> Comparison of sample means</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Econometrics and Statistics</strong>" was written by Jean-Paul Renne. It was last built on 2025-02-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
